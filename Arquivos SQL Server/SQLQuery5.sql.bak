/* 	TSQL - LINGUAGEM DE TRANSAÇÃO. 
BLOCO DE PROGRAMAÇÃO NOMIADO E ANÔNIMO (SEM NOME E NÃO SALVOS)
BLOCOS ANÔNIMOS SÃO CRIADOS QUANDO QUEREMOS EXECUTALOS UMA SÓ VEZ OU TESTA-LOS */


/* BLOCO DE EXECUÇÃO */
BEGIN 
	PRINT 'BLOCO DE TESTE'
END 
GO

/* BLOCO DE ATRIBUIÇÃO DE VARIÁVEL */
DECLARE @CONTADOR INT
BEGIN 
	SET @CONTADOR = 5
	PRINT @CONTADOR
	SELECT @CONTADOR
END 
GO

/* NO SQL SERVER CADA COLINA VARIÁVEL LOCAL EXPRESSÃO E PARÂMETRO TEM UM TIPO */
DECLARE 
	@V_NUMERO NUMERIC (10,2)= 100.52,
	@V_DATA DATETIME = '20170215'
BEGIN
	PRINT 'VALOR NUMERICO: '+ CAST(@V_NUMERO AS VARCHAR)
	PRINT 'VALOR NUMERICO CONVERT: '+ CONVERT(VARCHAR, @V_NUMERO
	PRINT 'VALOR DE DATA CONVERT: '+CONVERT(VARCHAR, @V_DATA, 121)
	PRINT 'VALOR DE DATA CONVERT: '+CONVERT(VARCHAR, @V_DATA, 120)
	PRINT 'VALOR DE DATA CONVERT: '+CONVERT(VARCHAR, @V_DATA, 105)
END
GO

/* CRIAÇÃO DE TABELA - EXEMPLO */
CREATE DATABASE CONCESSIONARIA
GO

USE CONCESSIONARIA
GO 

DROP TABLE TB_CARROS
GO

CREATE TABLE TB_CARROS(
	CARROS VARCHAR(20) NOT NULL,
	FABRICANTE VARCHAR (30) NOT NULL
);
GO

INSERT INTO TB_CARROS VALUES 
('KA','FORD'),
('FIESTA','FORD'),
('PRISMA','FORD'),
('UNO','FIAT'),
('PALIO','FIAT'),
('DOBLO','FIAT'),
('CHEVETE','CHEVROLET'),
('OMEGA','CHEVROLET'),
('CLIO','RENAULT'),
('SANDEIRO','RENAULT');
GO

DECLARE 
	@V_CONT_FORD INT,
	@V_CONT_FIAT INT,
	@V_CONT_CHEVROLET INT,
	@V_CONT_RENAULT INT
BEGIN
	--METODO 1º - SELECT RETORNANDO UMA SIMPLES COLUNA E UM RESULTADO
	SET @V_CONT_FORD = SELECT COUNT(*) FROM TB_CARROS WHERE FABRICANTE = 'FORD'
	PRINT 'NUMEROS DE FORD: '+CAST(@V_CONT_FORD AS VARCHAR)

	--METODO 2º 
	SELECT @V_CONT_FIAT COUNT(*) FROM TB_CARROS WHERE FABRICANTE = 'FIAT'
	PRINT 'NUMEROS DE FIAT: '+CONVERT(VARCHAR, @V_CONT_FIAT)
END
GO